代码提示功能需求文档
1. 功能概述
目标：通过AI动态分析用户代码错误与行为模式，提供阶梯式、个性化的代码提示，降低学习挫败感，引导用户自主发现解题路径。
核心价值：

从“告知错误”升级为“启发思考”，培养算法思维；

结合心理状态调整交互策略，提升用户留存率。

2. 用户场景
场景	用户痛点	功能介入方式
多次提交错误（WA/TLE）	无法定位错误根源，盲目修改代码	基于错误类型生成分层提示
长时间未提交（卡顿思考）	缺乏思路引导，易放弃	根据思考时长推送启发式提问
重复相似错误（如边界问题）	未意识到思维盲区	定位弱点并推荐专项训练题
高焦虑值（频繁刷新/调试）	情绪化操作导致效率下降	切换鼓励性语气，提供简化版案例
3. 功能需求详述
3.1 触发条件与分级规则
触发类型	判定逻辑	提示级别
错误驱动	- 同一题目连续WA≥3次	初级提示
- 特定错误类型（如数组越界、死循环）	深度提示
行为驱动	- 单次思考时间＞5分钟（无代码修改）	初级提示
- 历史相似错误率＞40%	深度提示
心理驱动	- 焦虑值＞阈值（基于操作频率、调试次数计算）	语气调整+简化提示
3.2 提示内容设计
3.2.1 初级提示（启发式引导）

形式：侧边栏弹窗/代码行内注释（可选）

内容规则：

if 错误类型 == "边界条件错误":  
    提示 = "第{line}行循环的终止条件是否覆盖所有情况？试试输入n=0的测试用例。"  
elif 错误类型 == "时间复杂度高":  
    提示 = "当前算法可能在超大输入时超时，是否需要优化数据结构？"  
3.2.2 深度提示（算法解析）

形式：可折叠展开的详情面板（含流程图/伪代码）

内容规则：

if 题目标签 == "动态规划":  
    提示 = "核心模型：状态定义应包含子问题最优解，例如dp[i]可表示前i个元素的最大值。参考伪代码→"  
elif 题目标签 == "图论":  
    提示 = "本题需构建邻接表并遍历，点击查看BFS与DFS的适用场景对比图。"  
3.2.3 心理学干预策略

语气库：

焦虑值区间	语气风格	示例文案
低（0-30）	严谨技术型	“检测到第12行未处理负输入，建议增加abs()转换。”
中（30-70）	鼓励引导型	“接近成功！调整循环初始值可能解决越界问题~”
高（70-100）	轻松幽默型	“递归层数太多会栈溢出哦，试试迭代吧！(๑•̀ㅂ•́)و✧”
3.3 技术实现模块
错误检测引擎：

输入：用户代码、判题结果（WA/TLE/RE信息）

输出：错误类型标签（预定义20+类别）、关键代码行定位

方法：静态代码分析（AST解析） + 运行时日志模式匹配

AI提示生成器：

模型架构：

［用户代码］→ 特征提取 → ［错误类型］  
                     ↘ ［历史行为］ → 融合层 → 提示模板选择 → ［最终提示］  
                     ↗ ［心理状态］  
技术栈：Python + Transformers（轻量化微调模型）

实时推送服务：

协议：WebSocket长连接

性能要求：提示生成延迟＜500ms，支持10K+并发会话

4. 非功能性需求
类别	要求
性能	- 提示生成响应时间 ≤ 500ms
- 支持单节点1000+ QPS
安全性	- 用户代码与分析数据加密存储（AES-256）
- 防止提示内容被恶意注入（XSS过滤）
兼容性	- 支持Python/Java/C++等10+语言错误分析
- 适配Chrome/Firefox/Safari等主流浏览器
5. 数据流示意图
用户提交代码 → 判题机 → 错误日志  
                          ↓  
                  AI分析引擎（错误分类+行为分析）  
                          ↓  
          提示生成器 → 用户端实时推送  
                          ↓  
         用户交互数据（点击/采纳率） → 模型优化闭环  
